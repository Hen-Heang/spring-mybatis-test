<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.heang.springmybatistest.mapper.CategoryMapper">

    <!-- Result Map - DB column to Java field mapping -->
    <resultMap id="CategoryMap" type="com.heang.springmybatistest.model.Category">
        <id property="id" column="id"/>
        <result property="name" column="name"/>
        <result property="createdAt" column="created_at"/>
    </resultMap>

    <!-- INSERT -->
    <insert id="insertCategory" parameterType="com.heang.springmybatistest.dto.CategoryRequest">
        INSERT INTO category (name)
        VALUES (#{name})
    </insert>

    <!-- SELECT ALL -->
    <select id="selectCategoryList" resultMap="CategoryMap">
        SELECT id, name, created_at
        FROM category
        ORDER BY id DESC
    </select>

    <!-- SELECT BY ID -->
    <select id="selectCategoryById" parameterType="long" resultMap="CategoryMap">
        SELECT id, name, created_at
        FROM category
        WHERE id = #{id}
    </select>

    <!-- SELECT BY NAME -->
    <select id="selectCategoryByName" parameterType="String" resultMap="CategoryMap">
        SELECT id, name, created_at
        FROM category
        WHERE name = #{name}
    </select>

    <!-- UPDATE -->
    <update id="updateCategory">
        UPDATE category
        SET name = #{req.name}
        WHERE id = #{id}
    </update>

    <!-- DELETE -->
    <delete id="deleteCategory" parameterType="long">
        DELETE FROM category
        WHERE id = #{id}
    </delete>

    <!-- COUNT -->
    <select id="countCategory" resultType="int">
        SELECT COUNT(*)
        FROM category
    </select>

</mapper>
